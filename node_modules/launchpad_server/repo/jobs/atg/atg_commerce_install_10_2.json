{"id":"atg 10.2 install","script":{"working_dir":"/opt/atg","env":{"ATG_VERSION":"10.2","ATG_HOME":"/opt/atg/${ATG_VERSION}/home","DYNAMO_ROOT":"/opt/atg/${ATG_VERSION}","DYNAMO_HOME":"${ATG_ROOT}/home","JAVA_HOME":"/usr/java/jdk1.7.0_45","JAVA_VM":"/usr/java/jdk1.7.0_45/bin/java","ANT_HOME":"/opt/ant/1.9.0","ECOM_INSTALL_PROPS":"ecom_install.props","ACC_INSTALL_PROPS":"acc_install.props","CSC_INSTALL_PROPS":"csc_install.props","SEARCH_INSTALL_PROPS":"srch_install.props","ECOM_PATCH_PROPS":"ecom_patch.props","ACC_PATCH_PROPS":"acc_patch.props","CSC_PATCH_PROPS":"csc_patch.props","SEARCH_PATCH_PROPS":"srch_patch.props"},"install_commands":["yum -y install qs_ATG_10.2","unzip V377*","chmod +x ATG*.bin","./ATG*.bin -f ${ECOM_INSTALL_PROPS}","echo \"installing patch\"","yum -y install qs_ATG_PATCH_10.2.0.3","unzip V3779*","chmod +x ATG*.bin","./ATGv79*.bin -f ${ECOM_PATCH_PROPS}"]}}

VERSION=10.1.2
DEPLOY_DIR="/tmp/endeca_logging_configs"
RULES_FILE=LFen_rules.xml
RULES_DESTINATION=/opt/endeca/apps/LFen/control/
LFEN_LOCATION=/opt/endeca/apps/LFen/control/
TOOLS_LOCATION=/opt/endeca/ToolsAndFrameworks/3.1.1/server/bin/
PLATFORM_LOCATION=/opt/endeca/PlatformServices/6.1.3/tools/server/bin/
CAS_LOCATION=/opt/endeca/CAS/3.1.1/bin/
ENDECA_USER=endeca


chmod +x ./env_setup/scripts/master_env.sh
. ./env_setup/scripts/master_env.sh $ENVIRONMENT




for host in "${ENDECA_HOSTS[@]}"
do
:

        #copy configs over

        $SSH deploy@${host} "rm -rf ${DEPLOY_DIR}"
        $SSH deploy@${host} "mkdir -p ${DEPLOY_DIR}"
        rsync -a --exclude ".svn" ToolsAndFrameworks deploy@${host}:/${DEPLOY_DIR}
        rsync -a --exclude ".svn" PlatformServices deploy@${host}:/${DEPLOY_DIR}
        rsync -a --exclude ".svn" CAS deploy@${host}:/${DEPLOY_DIR}

        #Tools And Frameworks logging
        $SSH deploy@${host} "sudo -u ${ENDECA_USER} cp -rf ${DEPLOY_DIR}/ToolsAndFrameworks/conf /opt/endeca/ToolsAndFrameworks/3.1.1/server/workspace
        $SSH deploy@${host} "sudo -u ${ENDECA_USER} cp -rf ${DEPLOY_DIR}/ToolsAndFrameworks/ifcr/* /opt/endeca/ToolsAndFrameworks/3.1.1/server/workspace/webapps/ifcr/WEB-INF

         #platform services logging
         $SSH deploy@${host} "sudo -u ${ENDECA_USER} cp -rf ${DEPLOY_DIR}/PlatformServices/conf /opt/endeca/PlatformServices/workspace/
        
         #CAS logging
         $SSH deploy@${host} "sudo -u ${ENDECA_USER} cp -rf ${DEPLOY_DIR}/CAS/conf /opt/endeca/CAS/workspace

        $SSH deploy@${host} "sudo -u ${ENDECA_USER} cp -rf ${DEPLOY_DIR}/install ${DEPLOY_DIR}/scripts /home/endeca"
            

    
done